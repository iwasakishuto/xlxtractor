(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7641:function(e,t,n){Promise.resolve().then(n.bind(n,1697))},1697:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ee}});var l=n(7437),a=n(2265),r=n(5392),s=n(6910),o=e=>{let{id:t,loading:n=!1,text:a="Any File(s)",inputProps:o={},labelProps:i={},className:c="",...d}=e;return(0,l.jsx)("div",{...d,className:"flex items-center justify-center w-full h-full ".concat(c),children:(0,l.jsxs)("label",{htmlFor:t,...i,className:"flex flex-col items-center justify-center w-full h-full border-2 border-slate-300 border-dashed rounded-lg cursor-pointer bg-slate-50 dark:hover:bg-bray-800 dark:bg-slate-700 hover:bg-slate-100 dark:border-slate-600 dark:hover:border-slate-500 dark:hover:bg-slate-600 ".concat(i.className||""),children:[(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[n?(0,l.jsx)(s.Z,{className:"w-10 h-10 mb-4 text-slate-500"}):(0,l.jsx)(r.Z,{className:"w-10 h-10 mb-4 text-slate-500"}),(0,l.jsx)("p",{className:"mb-2 text-base text-slate-500 dark:text-slate-400",children:"Click to upload or drag and drop"}),(0,l.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a})]}),(0,l.jsx)("input",{...o,id:t,className:"hidden ".concat(o.className||"")})]})})},i=n(5693),c=n(47);function d(e){let t=e.value;if(!(null==t||t!=t)){let n;i.isString(t)&&"'"==t.charAt(0)&&(t=t.substring(1)),e.style&&e.style.format&&(n=c.Workbook.fromXlsxFormat(e.style.format)[0]);let l=void 0!==n&&n.length>0?i.Globalize.format(t,n):t;t=i.escapeHtml(l)}return t}var u=e=>{let{wbrow:t,columns:n,rowIdx:a,maxRows:r=100,invisColCnt:s=0,isKpiTargetRow:o=!1,kpiColIdx:i=0,dateRowIdx:c=0,className:u="",...m}=e,x=[],p=0;for(let e=0;t.cells&&e<t.cells.length;e++){let l=t.cells[e],a=n[e];if(void 0===a||a.visible){let t="",a=1,r=1;p++,l&&(t=d(l),l.colSpan&&l.colSpan>1&&(p+=(a=function(e){let{columns:t,startFrom:n,colSpan:l}=e,a=l;for(let e=n;e<t.length&&e<n+l;e++){let n=t[e];n&&!n.visible&&a--}return a}({columns:n,startFrom:e,colSpan:l.colSpan}))-1),l.rowSpan&&(r=l.rowSpan)),x.push({colSpan:a,rowSpan:r,value:t})}}let h=r-p-s;for(let e=0;e<h;e++)x.push({colSpan:1,rowSpan:1,value:""});return(0,l.jsx)("tr",{...m,className:"border-slate-800 border-2 table-wbrow align-middle ".concat(u),children:x.map((e,t)=>{let{colSpan:n,rowSpan:r,value:s}=e;return(0,l.jsx)("td",{className:"truncate px-2 py-1 border border-1 border-slate-800 max-w-48 ".concat(a===c&&t>=i?"bg-yellow-300 ".concat(t===i?"font-bold":""):o&&t>=i?"bg-amber-400 ".concat(t===i?"font-bold":""):t===i?"bg-red-300 font-bold":""),colSpan:n,rowSpan:r,children:s},t)})})},m=e=>{let{worksheet:t,kpis:n,dateRowIdx:a=0,kpiColIdx:r=0,maxColumns:s=100,maxRows:o=200,className:i="",...c}=e;if(!t)return(0,l.jsx)("div",{className:"text-red-100",children:"Please Upload the Excel File Correctly"});let d=t.columns||[],m=t.rows.filter(e=>void 0===e||e.visible).slice(0,o),x=d.length;for(let e of m)e&&e.cells&&(x=Math.max(x,e.cells.length));return x=Math.min(x,s),(0,l.jsx)("div",{className:"w-full overflow-x-auto h-full",children:(0,l.jsxs)("table",{className:"border-collapse table-fixd w-full shadow-md rounded-xl bg-white text-slate-800 ".concat(i),...c,children:[(0,l.jsx)("colgroup",{children:d.slice(0,x).filter(e=>e.visible).map((e,t)=>(0,l.jsx)("col",{width:e.autoWidth?"":null!=e.width?"".concat(e.width,"px"):"60px"},t))}),(0,l.jsx)("tbody",{className:"table-row-group",children:m.map((e,t)=>(0,l.jsx)(u,{rowIdx:t,wbrow:e,columns:d,maxRows:x,invisColCnt:d.filter(e=>!1===e.visible).length,kpiColIdx:r,dateRowIdx:a,isKpiTargetRow:n.some(e=>e.row===t)},"row-".concat(t)))})]})})},x=n(6840),p=n(1824),h=e=>{let{workbook:t,sheetIndex:n,setSheetIndex:a,className:r="",...s}=e;return(0,l.jsx)("div",{...s,className:"w-full ".concat(r),children:(0,l.jsx)(p.Z,{value:n,onChange:(e,t)=>{a(t)},TabIndicatorProps:{style:{backgroundColor:"rgb(248, 250, 252)",height:"4px"}},textColor:"inherit",variant:"scrollable",scrollButtons:"auto","aria-label":"sheet name tabs",className:"bg-green-700 text-slate-50 p-0",children:t.sheets.map((e,t)=>(0,l.jsx)(x.Z,{value:t,label:e.name},t))})})},f=n(278),b=n(8836);let g=(0,b.ZP)(f.Z,{shouldForwardProp:e=>!["open","drawerWidth"].includes(e)})(e=>{let{theme:t,open:n,drawerWidth:l}=e;return{transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),...n&&{width:"calc(100% - ".concat(l,"px)"),marginLeft:"".concat(l,"px"),transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})}}});var w=n(2056),v=n(8315),j=n(7719);let k=a.forwardRef(function(e,t){return(0,l.jsx)(w.Y,{min:0,step:1,slots:{root:S,input:C,incrementButton:Z,decrementButton:Z},slotProps:{incrementButton:{children:"▴"},decrementButton:{children:"▾"}},...e,ref:t})}),N={100:"#DAECFF",200:"#80BFFF",400:"#3399FF",500:"#007FFF",600:"#0072E5",700:"#0059B2"},y={50:"#F3F6F9",100:"#E5EAF2",200:"#DAE2ED",300:"#C7D0DD",400:"#B0B8C4",500:"#9DA8B7",600:"#6B7A90",700:"#434D5B",800:"#303740",900:"#1C2025"},S=(0,j.Z)("div")(e=>{let{theme:t}=e;return"\n  font-family: 'IBM Plex Sans', sans-serif;\n  font-weight: 400;\n  border-radius: 8px;\n  color: ".concat("dark"===t.palette.mode?y[300]:y[900],";\n  background: ").concat("dark"===t.palette.mode?y[900]:"#fff",";\n  border: 1px solid ").concat("dark"===t.palette.mode?y[700]:y[200],";\n  box-shadow: 0px 2px 4px ").concat("dark"===t.palette.mode?"rgba(0,0,0, 0.5)":"rgba(0,0,0, 0.05)",";\n  display: grid;\n  grid-template-columns: 1fr 19px;\n  grid-template-rows: 1fr 1fr;\n  overflow: hidden;\n  column-gap: 8px;\n  padding: 4px;\n\n  &.").concat(v.S.focused," {\n    border-color: ").concat(N[400],";\n    box-shadow: 0 0 0 3px ").concat("dark"===t.palette.mode?N[700]:N[200],";\n  }\n\n  &:hover {\n    border-color: ").concat(N[400],";\n  }\n\n  // firefox\n  &:focus-visible {\n    outline: 0;\n  }\n")}),C=(0,j.Z)("input")(e=>{let{theme:t}=e;return"\n  font-size: 0.875rem;\n  font-family: inherit;\n  font-weight: 400;\n  line-height: 1.5;\n  grid-column: 1/2;\n  grid-row: 1/3;\n  color: ".concat("dark"===t.palette.mode?y[300]:y[900],";\n  background: inherit;\n  border: none;\n  border-radius: inherit;\n  padding: 8px 12px;\n  outline: 0;\n")}),Z=(0,j.Z)("button")(e=>{let{theme:t}=e;return"\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: center;\n  align-items: center;\n  appearance: none;\n  padding: 0;\n  width: 19px;\n  height: 19px;\n  font-family: system-ui, sans-serif;\n  font-size: 0.875rem;\n  line-height: 1;\n  box-sizing: border-box;\n  background: ".concat("dark"===t.palette.mode?y[900]:"#fff",";\n  border: 0;\n  color: ").concat("dark"===t.palette.mode?y[300]:y[900],";\n  transition-property: all;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 120ms;\n\n  &:hover {\n    background: ").concat("dark"===t.palette.mode?y[800]:y[50],";\n    border-color: ").concat("dark"===t.palette.mode?y[600]:y[300],";\n    cursor: pointer;\n  }\n\n  &.").concat(v.S.incrementButton," {\n    grid-column: 2/3;\n    grid-row: 1/2;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border: 1px solid;\n    border-bottom: 0;\n    border-color: ").concat("dark"===t.palette.mode?y[700]:y[200],";\n    background: ").concat("dark"===t.palette.mode?y[900]:y[50],";\n    color: ").concat("dark"===t.palette.mode?y[200]:y[900],";\n\n    &:hover {\n      cursor: pointer;\n      color: #FFF;\n      background: ").concat("dark"===t.palette.mode?N[600]:N[500],";\n      border-color: ").concat("dark"===t.palette.mode?N[400]:N[600],";\n    }\n  }\n\n  &.").concat(v.S.decrementButton," {\n    grid-column: 2/3;\n    grid-row: 2/3;\n    border-bottom-left-radius: 4px;\n    border-bottom-right-radius: 4px;\n    border: 1px solid;\n    border-color: ").concat("dark"===t.palette.mode?y[700]:y[200],";\n    background: ").concat("dark"===t.palette.mode?y[900]:y[50],";\n    color: ").concat("dark"===t.palette.mode?y[200]:y[900],";\n  }\n\n  &:hover {\n    cursor: pointer;\n    color: #FFF;\n    background: ").concat("dark"===t.palette.mode?N[600]:N[500],";\n    border-color: ").concat("dark"===t.palette.mode?N[400]:N[600],";\n  }\n\n  & .arrow {\n    transform: translateY(-1px);\n  }\n\n  & .arrow {\n    transform: translateY(-1px);\n  }\n")});var F=n(2e3),I=n(6969),P=n(8963),R=n(3680),E=n(1518),D=n(6273),O=n(6285),B=n(5195),A=n(5996),z=n(7002),K=n(8563),L=n(2508),M=n(9016),H=e=>{let{sheet:t,kpiColIdx:n,dateRowIdx:r,kpis:s,setKpiColIdx:o,setDateRowIdx:i,setKpis:c,kpiOptions:u,excelFilename:m="KPIs.xlsx",className:x="",...p}=e,{showAlertSnack:h}=(0,a.useContext)(F.SnackbarContext);return(0,l.jsxs)(B.Z,{...p,className:"max-w-md px-4 py-2 min-w-80 mx-auto bg-slate-50 overflow-y-auto ".concat(x),children:[(0,l.jsx)(z.Z,{action:(0,l.jsx)(E.Z,{className:"mr-1"}),title:"設定",className:"border-b-2 border-slate-400 pb-1"}),(0,l.jsx)(A.Z,{children:(0,l.jsxs)(L.ZP,{container:!0,spacing:1,className:"mt-4",children:[(0,l.jsxs)(L.ZP,{xs:12,sm:6,container:!0,className:"items-center",children:[(0,l.jsx)("label",{className:"ml-auto mr-1",id:"kpi",children:"KPI列："}),(0,l.jsx)(k,{id:"kpi",value:n,onChange:e=>{e.target instanceof HTMLInputElement&&o(Number(e.target.value))},className:"w-16 mr-auto"})]}),(0,l.jsxs)(L.ZP,{xs:12,sm:6,container:!0,className:"items-center",children:[(0,l.jsx)("label",{className:"ml-auto mr-1",htmlFor:"date",children:"日付行："}),(0,l.jsx)(k,{id:"date",value:r,onChange:e=>{e.target instanceof HTMLInputElement&&i(Number(e.target.value))},className:"w-16 mr-auto"})]}),(0,l.jsx)(L.ZP,{item:!0,xs:12,className:"mt-6",children:(0,l.jsx)(D.Z,{multiple:!0,disableCloseOnSelect:!0,options:u,getOptionLabel:e=>e.label,isOptionEqualToValue:(e,t)=>e.row===t.row,renderOption:(e,t,n)=>{let{className:r="",...s}=e,{selected:o}=n;return(0,a.createElement)("li",{...s,className:"".concat(r," text-sm"),key:t.row,children:[(0,l.jsx)(K.Z,{icon:(0,l.jsx)(P.Z,{fontSize:"small"}),checkedIcon:(0,l.jsx)(I.Z,{fontSize:"small"}),checked:o,className:"mr-2 py-0"}),t.label]})},renderInput:e=>(0,l.jsx)(M.Z,{...e,label:"KPIs",placeholder:"[Alt] + [↓]"}),className:"w-full text-xl",value:s,size:"small",onChange:(e,t)=>{c(t),console.log(["newValue",t])},ChipProps:{className:"bg-orange-200"}})}),(0,l.jsx)(L.ZP,{item:!0,xs:12,className:"mt-8",children:(0,l.jsx)(O.Z,{className:"normal-case font-bold w-full py-2 bg-green-700 text-slate-100 hover:bg-green-600 hover:text-white",endIcon:(0,l.jsx)(R.Z,{}),onClick:e=>{if(null!==t){let e=m+".kpi.json",l=function(e){let{sheet:t,kpis:n,kpiColIdx:l,dateRowIdx:a}=e,r=t.columns||[];function s(e,t){let n="",l=[];return e.cells.forEach((e,a)=>{let s=r[a];(void 0===s||s.visible)&&(a===t&&(n=d(e)),a>t&&l.push(d(e)))}),[n,l]}let o={Date:[],KPIs:{},excelFilename:""};return t.rows&&t.rows.filter(e=>void 0===e||e.visible).forEach((e,t)=>{if(t===a){let[t,n]=s(e,l);o.Date=n}if(n.some(e=>e.row===t)){let[t,n]=s(e,l);o.KPIs[t]=n}}),o}({sheet:t,kpis:s,kpiColIdx:n,dateRowIdx:r});l.excelFilename=m,function(e,t){let n=new Blob([JSON.stringify(e)],{type:"application/json"}),l=URL.createObjectURL(n),a=document.createElement("a");a.href=l,a.download=t,a.click(),URL.revokeObjectURL(l)}(l,e),h({message:"KPI file '".concat(e,"' was downloaded successfully"),severity:"success"})}else h({message:"Please Upload the Excel File Correctly",severity:"error"})},children:"Download KPIs"})})]})})]})};let T=(0,b.ZP)("div")(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",padding:t.spacing(0,1),...t.mixins.toolbar,justifyContent:"flex-end"}}),U=(0,b.ZP)("main",{shouldForwardProp:e=>!["open","drawerWidth"].includes(e)})(e=>{let{theme:t,open:n,drawerWidth:l}=e;return{flexGrow:1,padding:t.spacing(3),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginLeft:"-".concat(l,"px"),...n&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginLeft:0}}}),W=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],_=["New MRR","LTV","CAC","Magic Number","Burn Multiple","Net Burn","ARPU","ARR","MRR","Quick Ratio","Churn Rate","NPS","CES","COGS","R&D","S&M","G&A","FCF"];var G=n(6849),V=n(8740),Y=n(3801),q=n(8416),J=n(8826),Q=n(3206),X=n(6676),$=n(9835),ee=()=>{let[e,t]=(0,a.useState)(!1),[n,r]=(0,a.useState)(null),[s,i]=(0,a.useState)(0),[u,x]=(0,a.useState)(!1),[p,f]=(0,a.useState)(""),[b,w]=(0,a.useState)([]),[v,j]=(0,a.useState)([]),[k,N]=(0,a.useState)(0),[y,S]=(0,a.useState)(0);return(0,a.useEffect)(()=>{null!==n&&(w([]),j([]),N(0),S(0))},[s]),(0,a.useEffect)(()=>{if(null!==n){let e=[],t=[],l=n.sheets[s].columns;n.sheets[s].rows.filter(e=>void 0===e||e.visible).forEach((n,a)=>{let r=n.cells.filter((e,t)=>void 0===l[t]||l[t].visible);if(r[k]&&r[k].value){let n=d(r[k]);e.map(e=>e.label).includes(n)||(_.some(e=>n.includes(e))&&(t=[...t,{label:n,row:a}]),e=[...e,{label:n,row:a}])}}),w(t),j(e)}},[k]),(0,l.jsxs)("div",{className:"flex min-h-full",children:[(0,l.jsx)(g,{position:"fixed",className:"bg-green-700",open:e,drawerWidth:400,style:{height:"".concat(64,"px")},children:(0,l.jsxs)(X.Z,{children:[(0,l.jsx)(Q.Z,{color:"inherit","aria-label":"open drawer",onClick:()=>{t(!0)},edge:"start",sx:{mr:2,...e&&{display:"none"}},children:(0,l.jsx)(V.Z,{})}),(0,l.jsx)($.Z,{variant:"h6",noWrap:!0,component:"div",children:"Excel Extractor"}),(0,l.jsx)(Y.Z,{className:"ml-auto mr-2",alt:"Icon",src:"/favicon.jpg"})]})}),(0,l.jsxs)(J.ZP,{sx:{width:400,"& .MuiDrawer-paper":{width:400,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:e,className:"flex-shrink-0",PaperProps:{className:"bg-slate-200 text-slate-800"},children:[(0,l.jsx)(T,{className:"bg-slate-800 text-slate-200",children:(0,l.jsxs)("div",{className:"flex items-center w-full",children:[(0,l.jsx)("div",{className:"mx-auto text-xl font-bold",children:"Settings"}),(0,l.jsx)(Q.Z,{onClick:()=>{t(!1)},children:(0,l.jsx)(G.Z,{className:"text-slate-100"})})]})}),(0,l.jsx)(q.Z,{}),(0,l.jsx)("div",{style:{width:340},className:"mx-auto mt-2",children:(0,l.jsx)(H,{sheet:null!==n?n.sheets[s]:null,kpiColIdx:k,dateRowIdx:y,kpis:b,setKpiColIdx:N,setDateRowIdx:S,setKpis:w,kpiOptions:v,excelFilename:p})})]}),(0,l.jsxs)(U,{open:e,drawerWidth:400,className:"bg-slate-200 text-slate-800 h-screen p-0",children:[(0,l.jsx)(T,{}),(0,l.jsxs)("div",{className:"w-full flex",style:{height:"calc(100% - ".concat(64,"px)")},children:[(0,l.jsx)("div",{className:"max-w-4xl 2xl:max-w-7xl w-full bg-slate-100 p-6",children:(0,l.jsx)("div",{className:"flex flex-col h-full",children:(0,l.jsx)("div",{className:"flex-1 items-stretch w-full h-full",children:null===n?(0,l.jsx)(o,{id:"excel-file",className:"w-full h-full px-6 py-2",text:"Any Excel file here!!",inputProps:{type:"file",accept:W.join(", "),onChange:e=>{e.preventDefault();let t=e.currentTarget.files;if(t&&t.length){let e=t[0];f(e.name),x(!0);let n=new FileReader;n.onload=()=>{n.result&&new c.Workbook().loadAsync(n.result,e=>{r(e),x(!1)})},n.readAsDataURL(e)}}},loading:u}):(0,l.jsxs)("div",{className:"w-full h-full px-6 py-2",children:[(0,l.jsx)(h,{workbook:n,sheetIndex:s,setSheetIndex:i}),(0,l.jsx)(m,{worksheet:null==n?void 0:n.sheets[s],dateRowIdx:y,kpiColIdx:k,kpis:b})]})})})}),(0,l.jsx)("div",{className:"w-full flex-1",children:!e&&(0,l.jsx)(H,{sheet:null!==n?n.sheets[s]:null,kpiColIdx:k,dateRowIdx:y,kpis:b,setKpiColIdx:N,setDateRowIdx:S,setKpis:w,kpiOptions:v,className:"max-h-full",excelFilename:p})})]})]})]})}},2e3:function(e,t,n){"use strict";n.r(t),n.d(t,{SnackbarContext:function(){return i},SnackbarContextProvider:function(){return c}});var l=n(7437),a=n(3731),r=n(9221),s=n(6251),o=n(2265);/**
 * @file React component of buttons with multiple effects.
 * @author Shuto Iwasaki <https://github.com/iwasakishuto>
 * @copyright Shuto Iwasaki 2024
 * @license MIT
 * @reference <https://mui.com/components/snackbars/>
 */let i=(0,o.createContext)(void 0),c=e=>{let{children:t}=e,[n,c]=(0,o.useState)({isOpen:!1,message:"",severity:"error",vertical:"bottom",horizontal:"right",autoHideDuration:3e3}),d=()=>{c({isOpen:!1,message:"",severity:"error",vertical:"bottom",horizontal:"left",autoHideDuration:3e3})};return(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)(i.Provider,{value:{showAlertSnack:e=>{let{message:t,severity:n="error",vertical:l="bottom",horizontal:a="right",autoHideDuration:r=3e3}=e;c({isOpen:!0,message:t,severity:n,vertical:l,horizontal:a,autoHideDuration:r})}},children:t}),(0,l.jsx)(s.Z,{open:n.isOpen,autoHideDuration:n.autoHideDuration,anchorOrigin:{vertical:n.vertical,horizontal:n.horizontal},TransitionComponent:e=>(0,l.jsx)(r.Z,{...e,direction:"right"}),onClose:d,className:n.isOpen?"":"hidden",children:(0,l.jsx)(a.Z,{onClose:d,severity:n.severity,className:"w-full",children:n.message})})]})}}},function(e){e.O(0,[565,196,493,334,363,971,69,744],function(){return e(e.s=7641)}),_N_E=e.O()}]);