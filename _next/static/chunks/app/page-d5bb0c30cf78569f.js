(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7641:function(e,n,t){Promise.resolve().then(t.bind(t,9988))},9988:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eu}});var a=t(7437),s=t(2265),o=t(5392),l=t(6910),r=e=>{let{id:n,loading:t=!1,text:s="Any File(s)",inputProps:r={},labelProps:i={},className:c="",...d}=e;return(0,a.jsx)("div",{...d,className:"flex items-center justify-center w-full h-full ".concat(c),children:(0,a.jsxs)("label",{htmlFor:n,...i,className:"flex flex-col items-center justify-center w-full h-full border-2 border-slate-300 border-dashed rounded-lg cursor-pointer bg-slate-50 dark:hover:bg-bray-800 dark:bg-slate-700 hover:bg-slate-100 dark:border-slate-600 dark:hover:border-slate-500 dark:hover:bg-slate-600 ".concat(i.className||""),children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[t?(0,a.jsx)(l.Z,{className:"w-10 h-10 mb-4 text-slate-500"}):(0,a.jsx)(o.Z,{className:"w-10 h-10 mb-4 text-slate-500"}),(0,a.jsx)("p",{className:"mb-2 text-base text-slate-500 dark:text-slate-400",children:"Click to upload or drag and drop"}),(0,a.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s})]}),(0,a.jsx)("input",{...r,id:n,className:"hidden ".concat(r.className||"")})]})})},i=t(5693),c=t(47);function d(e){return void 0===e||e.visible}function m(e){return void 0===e||e.visible}function u(e){let{wbrow:n,columns:t,idx:a}=e,s=0,o=null,l=1,r=1,m=n.cells[a],u=t[a];return(void 0===u||u.visible)&&(s++,m?(o=function(e){let n=e.value;if(null==n||n!=n)null===n&&(n="");else{let t;i.isString(n)&&"'"==n.charAt(0)&&(n=n.substring(1)),e.style&&e.style.format&&(t=c.Workbook.fromXlsxFormat(e.style.format)[0]);let a=void 0!==t&&t.length>0?i.Globalize.format(n,t):n;n=i.escapeHtml(a)}return n}(m),m.colSpan&&m.colSpan>1&&(s+=(l=function(e){let{columns:n,startFrom:t,colSpan:a}=e,s=a;for(let e=t;e<n.length&&e<t+a;e++)!d(n[e])&&s--;return s}({columns:t,startFrom:a,colSpan:m.colSpan}))-1,a+=m.colSpan-1),m.rowSpan&&(r=m.rowSpan)):void 0===m&&(o="")),{value:o,rowSpan:r,colSpan:l,num_cell:s,idx:a}}var x=e=>{let{wbrow:n,columns:t,rowIdx:s,maxRows:o=100,invisColCnt:l=0,isKpiTargetRow:r=!1,kpiColIdx:i=0,dateRowIdx:c=0,className:d="",...m}=e,x=[],p=0;for(let e=0;n.cells&&e<n.cells.length&&!(e>=o);e++){let a=u({wbrow:n,columns:t,idx:e});null!==a.value&&(x.push({scol:e,ecol:a.idx,colSpan:a.colSpan,rowSpan:a.rowSpan,value:a.value}),p+=a.num_cell),e=a.idx}let h=o-p-l;for(let e=0;e<h;e++)x.push({scol:p+e,ecol:p+e,colSpan:1,rowSpan:1,value:""});return(0,a.jsx)("tr",{...m,className:"border-slate-800 border-2 table-wbrow align-middle ".concat(d),children:x.map((e,n)=>{let{scol:t,ecol:o,colSpan:l,rowSpan:d,value:m}=e;return(0,a.jsx)("td",{className:"truncate px-2 py-1 border border-1 border-slate-800 max-w-48 ".concat(s===c&&t>=i?"bg-yellow-300 ".concat(t<=i&&i<=o?"font-bold":""):r&&t>=i?"bg-amber-400 ".concat(t<=i&&i<=o?"font-bold":""):t<=i&&i<=o?"bg-red-300 font-bold":""),colSpan:l,children:m},n)})})},p=e=>{let{worksheet:n,kpis:t,dateRowIdx:s=0,kpiColIdx:o=0,maxColumns:l=100,maxRows:r=200,className:i="",...c}=e;if(!n)return(0,a.jsx)("div",{className:"text-red-100",children:"Please Upload the Excel File Correctly"});let d=n.columns||[],m=n.rows.filter(e=>void 0===e||e.visible).slice(0,r),u=d.length;for(let e of m)e&&e.cells&&(u=Math.max(u,e.cells.length));return u=Math.min(u,l),(0,a.jsx)("div",{className:"w-full overflow-x-auto h-full",children:(0,a.jsxs)("table",{className:"border-collapse table-fixd w-full shadow-md rounded-xl bg-white text-slate-800 ".concat(i),...c,children:[(0,a.jsx)("colgroup",{children:d.filter(e=>e.visible).slice(0,u).map((e,n)=>(0,a.jsx)("col",{width:e.autoWidth?"":null!=e.width?"".concat(e.width,"px"):"60px"},n))}),(0,a.jsx)("tbody",{className:"table-row-group",children:m.map((e,n)=>(0,a.jsx)(x,{rowIdx:n,wbrow:e,columns:d,maxRows:u,invisColCnt:d.filter(e=>!1===e.visible).length,kpiColIdx:o,dateRowIdx:s,isKpiTargetRow:t.some(e=>e.row===n)},"row-".concat(n)))})]})})},h=t(6840),v=t(1824),f=e=>{let{workbook:n,sheetIndex:t,setSheetIndex:s,className:o="",...l}=e;return(0,a.jsx)("div",{...l,className:"w-full ".concat(o),children:(0,a.jsx)(v.Z,{value:t,onChange:(e,n)=>{s(n)},TabIndicatorProps:{style:{backgroundColor:"rgb(248, 250, 252)",height:"4px"}},textColor:"inherit",variant:"scrollable",scrollButtons:"auto","aria-label":"sheet name tabs",className:"bg-green-700 text-slate-50 p-0",children:n.sheets.map((e,n)=>(0,a.jsx)(h.Z,{value:n,label:e.name},n))})})},b=t(278),g=t(8836);let w=(0,g.ZP)(b.Z,{shouldForwardProp:e=>!["open","drawerWidth"].includes(e)})(e=>{let{theme:n,open:t,drawerWidth:a}=e;return{transition:n.transitions.create(["margin","width"],{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen}),...t&&{width:"calc(100% - ".concat(a,"px)"),marginLeft:"".concat(a,"px"),transition:n.transitions.create(["margin","width"],{easing:n.transitions.easing.easeOut,duration:n.transitions.duration.enteringScreen})}}});var j=t(2e3),N=t(4091);let S=(0,N.Z)("https://iwasakishuto.github.io","/xlxtractor");function k(e,n){let t=document.createElement("a");t.href=e,t.download=n,t.click(),URL.revokeObjectURL(e)}var C=t(3680),y=t(6285),Z=t(5195),P=t(5996),I=t(7002),F=t(3340),R=e=>{let{className:n="",...t}=e,{showAlertSnack:o}=(0,s.useContext)(j.SnackbarContext);return(0,a.jsxs)(Z.Z,{...t,className:"max-w-md px-4 py-2 min-w-80 mx-auto bg-slate-50 overflow-y-auto ".concat(n),children:[(0,a.jsx)(I.Z,{title:"Sample Excel File",className:"border-b-2 border-slate-400 pb-1"}),(0,a.jsx)(F.Z,{component:"img",height:"194",image:(0,N.Z)(S,"/excel/SaaS_KPI_sample_xl_v0.png"),alt:"Sample Excel"}),(0,a.jsx)(P.Z,{children:(0,a.jsx)(y.Z,{className:"normal-case font-bold w-full py-2 bg-rose-600 text-slate-100 hover:bg-rose-700 hover:text-white",endIcon:(0,a.jsx)(C.Z,{}),onClick:e=>{try{let e=(0,N.Z)(S,"/excel/SaaS_KPI_v0.xlsx");k(e,"SaaS_KPI_v0.xlsx"),o({message:"Downloading sample excel file from ".concat(e,"..."),severity:"info"})}catch(e){o({message:"Failed to download sample excel file.\n".concat(e),severity:"error"})}},children:"Download Excel"})})]})};let E=[{no:"203",name:"ペイトナー",invested:!1},{no:"221",name:"TKG",invested:!1},{no:"254",name:"Shizai",invested:!1},{no:"291",name:"route-D",invested:!1},{no:"294",name:"O",invested:!1},{no:"332",name:"PICK",invested:!1},{no:"340",name:"フツパー",invested:!1},{no:"344",name:"SUPWAT",invested:!1},{no:"353",name:"Swish",invested:!1},{no:"361",name:"リーテックス",invested:!1},{no:"379",name:"日本大学医学部松本太郎",invested:!1},{no:"380",name:"ジーニアルテクノロジー",invested:!1},{no:"392",name:"fruor",invested:!1},{no:"399",name:"HERP",invested:!1},{no:"401",name:"Geek Guild",invested:!1},{no:"409",name:"Yoom",invested:!1},{no:"427",name:"Arrowhead(BlitzMe)",invested:!1},{no:"428",name:"UPWARD",invested:!1},{no:"467",name:"YourTrade",invested:!1},{no:"476",name:"Unperiod",invested:!1},{no:"488",name:"GOGEN",invested:!1},{no:"493",name:"KISH",invested:!1},{no:"495",name:"openpage",invested:!1},{no:"498",name:"ベースマキナ",invested:!1},{no:"499",name:"RemitAid",invested:!1},{no:"503",name:"仲さん",invested:!1},{no:"507",name:"Sun metalon",invested:!1},{no:"508",name:"ロジレス",invested:!1},{no:"512",name:"ファンファーレ",invested:!1},{no:"514",name:"Dioseve",invested:!1},{no:"521",name:"B4A",invested:!1},{no:"551",name:"SpaceGrab",invested:!1},{no:"558",name:"ハロウ",invested:!1},{no:"562",name:"Veneno",invested:!1},{no:"563",name:"fixU",invested:!1},{no:"567",name:"シンプルフォーム",invested:!1},{no:"570",name:"ログラス",invested:!1},{no:"581",name:"パートナープロップ",invested:!1},{no:"582",name:"プラチナバイオ",invested:!1},{no:"583",name:"Catalis Partners Group",invested:!1},{no:"585",name:"キュライオ",invested:!1},{no:"586",name:"リンケージ",invested:!1},{no:"588",name:"Quollio Technologies",invested:!1},{no:"594",name:"PeopleX",invested:!1},{no:"595",name:"スマイルワークス",invested:!1},{no:"596",name:"Takeme",invested:!1},{no:"597",name:"ブリングアウト",invested:!1},{no:"599",name:"TECH MONTSTER",invested:!1},{no:"600",name:"STRACT",invested:!1},{no:"603",name:"アルゴス",invested:!1},{no:"609",name:"Mellia",invested:!1},{no:"611",name:"サイバーコマンド",invested:!1},{no:"613",name:"リスマ",invested:!1},{no:"614",name:"ジンベイザメ",invested:!1},{no:"615",name:"villio",invested:!1},{no:"616",name:"Starley",invested:!1},{no:"617",name:"パブリックテクノロジーズ",invested:!1},{no:"618",name:"eaglys",invested:!1},{no:"619",name:"Boston Medical Science",invested:!1},{no:"620",name:"Dots for",invested:!1},{no:"621",name:"JIZAIE",invested:!1},{no:"622",name:"テラーノベル",invested:!1},{no:"625",name:"KIDS_SNACK_LAB",invested:!1},{no:"626",name:"Cuborex",invested:!1},{no:"627",name:"ZMP",invested:!1},{no:"628",name:"ファミリーテック",invested:!1},{no:"629",name:"Lezily",invested:!1},{no:"630",name:"ドットライフ",invested:!1},{no:"631",name:"WAVEE",invested:!1},{no:"632",name:"StartPass",invested:!1},{no:"001",name:"Ondeck",invested:!0},{no:"010",name:"福島SiC（増資）",invested:!0},{no:"011",name:"CSN",invested:!0},{no:"012",name:"Synappse",invested:!0},{no:"013",name:"Heartseed",invested:!0},{no:"019",name:"KYCC",invested:!0},{no:"024",name:"Qwintet",invested:!0},{no:"038",name:"SmartRyde",invested:!0},{no:"041",name:"カナリー",invested:!0},{no:"044",name:"ミツモア",invested:!0},{no:"045",name:"Varinos",invested:!0},{no:"055",name:"LocusBlue",invested:!0},{no:"065",name:"テオリアサイエンス",invested:!0},{no:"067",name:"MagicPod",invested:!0},{no:"081",name:"Fivot",invested:!0},{no:"084",name:"NHP",invested:!0},{no:"089",name:"Siiibo証券",invested:!0},{no:"094",name:"LISUTO",invested:!0},{no:"109",name:"TOKYO CREATION",invested:!0},{no:"111",name:"Logomix",invested:!0},{no:"125",name:"プレカル",invested:!0},{no:"137",name:"Goals",invested:!0},{no:"183",name:"ユートニック",invested:!0},{no:"214",name:"クラフトバンク",invested:!0},{no:"287",name:"Reborna_BioSciences",invested:!0},{no:"295",name:"Lisse",invested:!0},{no:"306",name:"ブルーモ証券",invested:!0},{no:"307",name:"Smartpay",invested:!0},{no:"308",name:"ファーメランタ",invested:!0},{no:"313",name:"XAION DATA",invested:!0},{no:"400",name:"Jamm",invested:!0},{no:"472",name:"HITOTSU",invested:!0},{no:"500",name:"Facilo",invested:!0},{no:"520",name:"goooods",invested:!0},{no:"526",name:"GenerativeX",invested:!0}];var D=t(6273),O=t(9016);function A(e){return"string"==typeof e?e:e.name}var B=e=>{let{company:n,setCompany:t,className:s="",...o}=e;return(0,a.jsx)(D.Z,{...o,freeSolo:!0,options:E,getOptionLabel:e=>"string"==typeof e?e:e.no.length>0?"".concat(e.no,".").concat(e.name):e.name,isOptionEqualToValue:(e,n)=>A(e)===A(n),className:"w-full text-xl ".concat(s),value:{no:"",name:n,invested:!1},size:"small",onChange:(e,n)=>{null!==n&&("string"==typeof n?t(n):t(n.name))},ChipProps:{className:"bg-orange-200"},renderInput:e=>(0,a.jsx)(O.Z,{...e,label:"企業名"})})},T=t(6969),K=t(8963),L=t(8563),_=e=>{let{sheet:n,kpis:t,setKpis:o,kpiOptions:l,className:r="",...i}=e;return(0,a.jsx)(D.Z,{...i,multiple:!0,disableCloseOnSelect:!0,options:l,getOptionLabel:e=>e.label,isOptionEqualToValue:(e,n)=>e.row===n.row,renderOption:(e,n,t)=>{let{className:o="",...l}=e,{selected:r}=t;return(0,s.createElement)("li",{...l,className:"".concat(o," text-sm"),key:n.row,children:[(0,a.jsx)(L.Z,{icon:(0,a.jsx)(K.Z,{fontSize:"small"}),checkedIcon:(0,a.jsx)(T.Z,{fontSize:"small"}),checked:r,className:"mr-2 py-0"}),n.label]})},renderInput:e=>(0,a.jsx)(O.Z,{...e,label:"KPIs",placeholder:"[Alt] + [↓]"}),className:"w-full text-xl ".concat(r),value:t,size:"small",onChange:(e,n)=>{o(n)},ChipProps:{className:"bg-orange-200"},disabled:null===n})};let z={100:"#DAECFF",200:"#80BFFF",400:"#3399FF",500:"#007FFF",600:"#0072E5",700:"#0059B2",900:"#003A75"},M={50:"#F3F6F9",100:"#E5EAF2",200:"#DAE2ED",300:"#C7D0DD",400:"#B0B8C4",500:"#9DA8B7",600:"#6B7A90",700:"#434D5B",800:"#303740",900:"#1C2025"};var H=t(2056),U=t(8315),G=t(7719);let W=s.forwardRef(function(e,n){return(0,a.jsx)(H.Y,{min:0,step:1,slots:{root:Y,input:V,incrementButton:X,decrementButton:X},slotProps:{incrementButton:{children:"▴"},decrementButton:{children:"▾"}},...e,ref:n})}),Y=(0,G.Z)("div")(e=>{let{theme:n}=e;return"\n  font-family: 'IBM Plex Sans', sans-serif;\n  font-weight: 400;\n  border-radius: 8px;\n  color: ".concat("dark"===n.palette.mode?M[300]:M[900],";\n  background: ").concat("dark"===n.palette.mode?M[900]:"#fff",";\n  border: 1px solid ").concat("dark"===n.palette.mode?M[700]:M[200],";\n  box-shadow: 0px 2px 4px ").concat("dark"===n.palette.mode?"rgba(0,0,0, 0.5)":"rgba(0,0,0, 0.05)",";\n  display: grid;\n  grid-template-columns: 1fr 19px;\n  grid-template-rows: 1fr 1fr;\n  overflow: hidden;\n  column-gap: 8px;\n  padding: 4px;\n\n  &.").concat(U.S.focused," {\n    border-color: ").concat(z[400],";\n    box-shadow: 0 0 0 3px ").concat("dark"===n.palette.mode?z[700]:z[200],";\n  }\n\n  &:hover {\n    border-color: ").concat(z[400],";\n  }\n\n  // firefox\n  &:focus-visible {\n    outline: 0;\n  }\n")}),V=(0,G.Z)("input")(e=>{let{theme:n}=e;return"\n  font-size: 0.875rem;\n  font-family: inherit;\n  font-weight: 400;\n  line-height: 1.5;\n  grid-column: 1/2;\n  grid-row: 1/3;\n  color: ".concat("dark"===n.palette.mode?M[300]:M[900],";\n  background: inherit;\n  border: none;\n  border-radius: inherit;\n  padding: 8px 12px;\n  outline: 0;\n")}),X=(0,G.Z)("button")(e=>{let{theme:n}=e;return"\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: center;\n  align-items: center;\n  appearance: none;\n  padding: 0;\n  width: 19px;\n  height: 19px;\n  font-family: system-ui, sans-serif;\n  font-size: 0.875rem;\n  line-height: 1;\n  box-sizing: border-box;\n  background: ".concat("dark"===n.palette.mode?M[900]:"#fff",";\n  border: 0;\n  color: ").concat("dark"===n.palette.mode?M[300]:M[900],";\n  transition-property: all;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 120ms;\n\n  &:hover {\n    background: ").concat("dark"===n.palette.mode?M[800]:M[50],";\n    border-color: ").concat("dark"===n.palette.mode?M[600]:M[300],";\n    cursor: pointer;\n  }\n\n  &.").concat(U.S.incrementButton," {\n    grid-column: 2/3;\n    grid-row: 1/2;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border: 1px solid;\n    border-bottom: 0;\n    border-color: ").concat("dark"===n.palette.mode?M[700]:M[200],";\n    background: ").concat("dark"===n.palette.mode?M[900]:M[50],";\n    color: ").concat("dark"===n.palette.mode?M[200]:M[900],";\n\n    &:hover {\n      cursor: pointer;\n      color: #FFF;\n      background: ").concat("dark"===n.palette.mode?z[600]:z[500],";\n      border-color: ").concat("dark"===n.palette.mode?z[400]:z[600],";\n    }\n  }\n\n  &.").concat(U.S.decrementButton," {\n    grid-column: 2/3;\n    grid-row: 2/3;\n    border-bottom-left-radius: 4px;\n    border-bottom-right-radius: 4px;\n    border: 1px solid;\n    border-color: ").concat("dark"===n.palette.mode?M[700]:M[200],";\n    background: ").concat("dark"===n.palette.mode?M[900]:M[50],";\n    color: ").concat("dark"===n.palette.mode?M[200]:M[900],";\n  }\n\n  &:hover {\n    cursor: pointer;\n    color: #FFF;\n    background: ").concat("dark"===n.palette.mode?z[600]:z[500],";\n    border-color: ").concat("dark"===n.palette.mode?z[400]:z[600],";\n  }\n\n  & .arrow {\n    transform: translateY(-1px);\n  }\n\n  & .arrow {\n    transform: translateY(-1px);\n  }\n")});var J=t(1518),Q=t(2508);let q=e=>{let{label:n,num:t,setNum:s,disabled:o}=e;return(0,a.jsxs)(Q.ZP,{xs:12,sm:6,container:!0,className:"items-center",children:[(0,a.jsxs)("label",{className:"ml-auto mr-1",id:"dispColumns",children:[n,"："]}),(0,a.jsx)(W,{id:"dispColumns",value:t,onChange:e=>{e.target instanceof HTMLInputElement&&s(Number(e.target.value))},onInputChange:e=>{e.target instanceof HTMLInputElement&&s(Number(e.target.value))},className:"w-16 mr-auto",disabled:o})]},n)};var $=e=>{let{sheet:n,excelFilename:t,setExcelFilename:o,company:l,setCompany:r,kpiColIdx:i,setKpiColIdx:c,dateRowIdx:d,setDateRowIdx:x,kpis:p,setKpis:h,kpiOptions:v,dispColumns:f,setDispColumns:b,dispRows:g,setDispRows:w,maxColumns:N,maxRows:S,className:F="",...R}=e,{showAlertSnack:E}=(0,s.useContext)(j.SnackbarContext);return(0,a.jsxs)(Z.Z,{...R,className:"max-w-md px-4 py-2 min-w-80 mx-auto bg-slate-50 overflow-y-auto ".concat(F),children:[(0,a.jsx)(I.Z,{action:(0,a.jsx)(J.Z,{className:"mr-1"}),title:"設定",className:"border-b-2 border-slate-400 pb-1"}),(0,a.jsx)(P.Z,{children:(0,a.jsxs)(Q.ZP,{container:!0,spacing:1,className:"mt-4",children:[t.length>0&&(0,a.jsxs)(Q.ZP,{container:!0,children:[(0,a.jsxs)(Q.ZP,{container:!0,xs:12,className:"mb-4 items-center w-full",children:[(0,a.jsx)("span",{className:"mr-auto",children:"Excel："}),(0,a.jsx)("code",{className:"ml-auto",children:t})]}),(0,a.jsx)(Q.ZP,{container:!0,xs:12,className:"mb-4 items-center w-full",children:(0,a.jsx)(B,{company:l,setCompany:r})}),(0,a.jsxs)(Q.ZP,{container:!0,xs:12,className:"mb-4 w-full",children:[(0,a.jsxs)(Q.ZP,{item:!0,xs:12,sm:6,className:"items-center flex",children:[(0,a.jsx)("span",{className:"ml-auto",children:"最大列数："}),(0,a.jsx)("code",{className:"mr-auto",children:N})]}),(0,a.jsxs)(Q.ZP,{item:!0,xs:12,sm:6,className:"items-center flex",children:[(0,a.jsx)("span",{className:"ml-auto",children:"最大行数："}),(0,a.jsx)("code",{className:"mr-auto",children:S})]})]})]}),(0,a.jsxs)(Q.ZP,{container:!0,className:"mb-6 items-center",children:[(0,a.jsx)(q,{label:"列数",num:f,setNum:b,disabled:null===n}),(0,a.jsx)(q,{label:"行数",num:g,setNum:w,disabled:null===n})]}),(0,a.jsxs)(Q.ZP,{container:!0,className:"mb-6 items-center",children:[(0,a.jsx)(q,{label:"KPI列",num:i,setNum:c,disabled:null===n}),(0,a.jsx)(q,{label:"日付行",num:d,setNum:x,disabled:null===n})]}),(0,a.jsx)(Q.ZP,{item:!0,xs:12,children:(0,a.jsx)(_,{sheet:n,kpis:p,setKpis:h,kpiOptions:v})}),(0,a.jsx)(Q.ZP,{item:!0,xs:12,className:"mt-8",children:(0,a.jsx)(y.Z,{className:"normal-case font-bold w-full py-2 bg-green-700 text-slate-100 hover:bg-green-600 hover:text-white",endIcon:(0,a.jsx)(C.Z,{}),onClick:e=>{if(null!==n){let e=t+".kpi.json",a=function(e){let{sheet:n,kpis:t,kpiColIdx:a,dateRowIdx:s}=e,o=n.columns||[];function l(e,n){let t="",a=[];for(let s=0;e.cells&&s<e.cells.length;s++){let{value:l,idx:r,num_cell:i}=u({wbrow:e,columns:o,idx:s});s<=n&&n<=r&&(t=l||""),s>n&&a.push(l);for(let e=0;e<i-1;e++)a.push(null);s=r}return[t,a]}let r={Date:[],KPIs:{},excelFilename:"",sheetName:"",company:""};return n.rows&&n.rows.filter(e=>m(e)).forEach((e,n)=>{if(n===s){let[n,t]=l(e,a);r.Date=t}if(t.some(e=>e.row===n)){let[n,t]=l(e,a);r.KPIs[n]=t}}),r}({sheet:n,kpis:p,kpiColIdx:i,dateRowIdx:d});a.excelFilename=t,a.sheetName=n.name,a.company=l,function(e,n){let t=new Blob([JSON.stringify(e)],{type:"application/json"});k(URL.createObjectURL(t),n)}(a,e),E({message:"KPI file '".concat(e,"' was downloaded successfully"),severity:"success"})}else E({message:"Please Upload the Excel File Correctly",severity:"error"})},children:"Download KPIs"})})]})})]})};let ee=(0,g.ZP)("div")(e=>{let{theme:n}=e;return{display:"flex",alignItems:"center",padding:n.spacing(0,1),...n.mixins.toolbar,justifyContent:"flex-end"}}),en=(0,g.ZP)("main",{shouldForwardProp:e=>!["open","drawerWidth"].includes(e)})(e=>{let{theme:n,open:t,drawerWidth:a}=e;return{flexGrow:1,padding:n.spacing(3),transition:n.transitions.create("margin",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen}),marginLeft:"-".concat(a,"px"),...t&&{transition:n.transitions.create("margin",{easing:n.transitions.easing.easeOut,duration:n.transitions.duration.enteringScreen}),marginLeft:0}}}),et=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],ea=["New MRR","LTV","CAC","Magic Number","Burn Multiple","Net Burn","ARPU","ARR","MRR","Quick Ratio","Churn Rate","NPS","CES","COGS","R&D","S&M","G&A","FCF"];var es=t(6849),eo=t(8740),el=t(3801),er=t(8416),ei=t(6892),ec=t(3206),ed=t(6676),em=t(9835),eu=()=>{let[e,n]=(0,s.useState)(!1),[t,o]=(0,s.useState)(null),[l,i]=(0,s.useState)(0),[x,h]=(0,s.useState)(!1),[v,b]=(0,s.useState)(""),[g,j]=(0,s.useState)(""),[k,C]=(0,s.useState)(0),[y,Z]=(0,s.useState)(0),[P,I]=(0,s.useState)([]),[F,E]=(0,s.useState)([]),[D,O]=(0,s.useState)(0),[A,B]=(0,s.useState)(0),[T,K]=(0,s.useState)(200),[L,_]=(0,s.useState)(100);return(0,s.useEffect)(()=>{if(null!==t){I([]),E([]),O(0),B(0);let e=t.sheets[l];e&&(C(e.rows.filter(e=>m(e)).length),Z(e.columns.filter(e=>d(e)).length))}},[l]),(0,s.useEffect)(()=>{if(null!==t){let e=[],n=[],a=t.sheets[l].columns||[];t.sheets[l].rows.filter(e=>void 0==e||e.visible).slice(0,T).forEach((t,s)=>{for(let o=0;t.cells&&o<t.cells.length;o++){let{value:l,idx:r}=u({wbrow:t,columns:a,idx:o});if(o<=D&&D<=r){null===l||e.map(e=>e.label).includes(l)||(ea.some(e=>null!==l&&l.includes(e))&&(n=[...n,{label:l,row:s}]),e=[...e,{label:l,row:s}]);break}o=r}}),I(n),E(e)}},[D,T,l]),(0,a.jsxs)("div",{className:"flex min-h-full",children:[(0,a.jsx)(w,{position:"fixed",className:"bg-green-700",open:e,drawerWidth:400,style:{height:"".concat(64,"px")},children:(0,a.jsxs)(ed.Z,{children:[(0,a.jsx)(ec.Z,{color:"inherit","aria-label":"open drawer",onClick:()=>{n(!0)},edge:"start",sx:{mr:2,...e&&{display:"none"}},children:(0,a.jsx)(eo.Z,{})}),(0,a.jsx)(em.Z,{variant:"h6",noWrap:!0,component:"div",children:"Excel Extractor"}),(0,a.jsx)(el.Z,{className:"ml-auto mr-2",alt:"Icon",src:(0,N.Z)(S,"favicon.png")})]})}),(0,a.jsxs)(ei.ZP,{sx:{width:400,"& .MuiDrawer-paper":{width:400,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:e,className:"flex-shrink-0",PaperProps:{className:"bg-slate-200 text-slate-800"},children:[(0,a.jsx)(ee,{className:"bg-slate-800 text-slate-200",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[(0,a.jsx)("div",{className:"mx-auto text-xl font-bold",children:"Settings"}),(0,a.jsx)(ec.Z,{onClick:()=>{n(!1)},children:(0,a.jsx)(es.Z,{className:"text-slate-100"})})]})}),(0,a.jsx)(er.Z,{}),(0,a.jsxs)("div",{style:{width:340},className:"mx-auto mt-2",children:[(0,a.jsx)($,{sheet:null!==t?t.sheets[l]:null,kpiColIdx:D,dateRowIdx:A,kpis:P,setKpiColIdx:O,setDateRowIdx:B,setKpis:I,kpiOptions:F,excelFilename:v,setExcelFilename:b,company:g,setCompany:j,dispColumns:L,setDispColumns:_,dispRows:T,setDispRows:K,maxColumns:y,maxRows:k}),(0,a.jsx)(R,{className:"mt-12"})]})]}),(0,a.jsxs)(en,{open:e,drawerWidth:400,className:"bg-slate-200 text-slate-800 h-screen p-0",children:[(0,a.jsx)(ee,{}),(0,a.jsxs)("div",{className:"w-full flex",style:{height:"calc(100% - ".concat(64,"px)")},children:[(0,a.jsx)("div",{className:"max-w-4xl 2xl:max-w-7xl w-full bg-slate-100 p-6",children:(0,a.jsx)("div",{className:"flex flex-col h-full",children:(0,a.jsx)("div",{className:"flex-1 items-stretch w-full h-full",children:null===t?(0,a.jsx)(r,{id:"excel-file",className:"w-full h-full px-6 py-2",text:"Any Excel file here!!",inputProps:{type:"file",accept:et.join(", "),onChange:e=>{e.preventDefault();let n=e.currentTarget.files;if(n&&n.length){let e=n[0];b(e.name),h(!0);let t=new FileReader;t.onload=()=>{t.result&&new c.Workbook().loadAsync(t.result,e=>{o(e),h(!1)})},t.readAsDataURL(e)}}},loading:x}):(0,a.jsxs)("div",{className:"w-full h-full px-6 py-2",children:[(0,a.jsx)(f,{workbook:t,sheetIndex:l,setSheetIndex:i}),(0,a.jsx)(p,{worksheet:null==t?void 0:t.sheets[l],dateRowIdx:A,kpiColIdx:D,kpis:P,maxRows:T,maxColumns:L})]})})})}),(0,a.jsx)("div",{className:"w-full flex-1",children:!e&&(0,a.jsx)($,{sheet:null!==t?t.sheets[l]:null,kpiColIdx:D,dateRowIdx:A,kpis:P,setKpiColIdx:O,setDateRowIdx:B,setKpis:I,kpiOptions:F,className:"max-h-full",excelFilename:v,setExcelFilename:b,company:g,setCompany:j,dispColumns:L,setDispColumns:_,dispRows:T,setDispRows:K,maxColumns:y,maxRows:k})})]})]})]})}},2e3:function(e,n,t){"use strict";t.r(n),t.d(n,{SnackbarContext:function(){return r},SnackbarContextProvider:function(){return i}});var a=t(7437),s=t(3731),o=t(6251),l=t(2265);/**
 * @file React component of buttons with multiple effects.
 * @author Shuto Iwasaki <https://github.com/iwasakishuto>
 * @copyright Shuto Iwasaki 2024
 * @license MIT
 * @reference <https://mui.com/components/snackbars/>
 */let r=(0,l.createContext)(void 0),i=e=>{let{children:n}=e,[t,i]=(0,l.useState)({isOpen:!1,message:"",severity:"error",vertical:"bottom",horizontal:"right",autoHideDuration:3e3}),c=()=>{i({isOpen:!1,message:"",severity:"error",vertical:"bottom",horizontal:"left",autoHideDuration:3e3})};return(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)(r.Provider,{value:{showAlertSnack:e=>{let{message:n,severity:t="error",vertical:a="bottom",horizontal:s="right",autoHideDuration:o=3e3}=e;i({isOpen:!0,message:n,severity:t,vertical:a,horizontal:s,autoHideDuration:o})}},children:n}),(0,a.jsx)(o.Z,{open:t.isOpen,autoHideDuration:t.autoHideDuration,anchorOrigin:{vertical:t.vertical,horizontal:t.horizontal},onClose:c,className:t.isOpen?"":"hidden",children:(0,a.jsx)(s.Z,{onClose:c,severity:t.severity,className:"w-full",children:t.message})})]})}}},function(e){e.O(0,[565,196,493,817,264,971,69,744],function(){return e(e.s=7641)}),_N_E=e.O()}]);