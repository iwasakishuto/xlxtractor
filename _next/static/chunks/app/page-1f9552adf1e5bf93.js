(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7641:function(e,t,l){Promise.resolve().then(l.bind(l,1192))},1192:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return ei}});var n=l(7437),a=l(2265),s=l(5392),r=l(6910),o=e=>{let{id:t,loading:l=!1,text:a="Any File(s)",inputProps:o={},labelProps:i={},className:c="",...d}=e;return(0,n.jsx)("div",{...d,className:"flex items-center justify-center w-full h-full ".concat(c),children:(0,n.jsxs)("label",{htmlFor:t,...i,className:"flex flex-col items-center justify-center w-full h-full border-2 border-slate-300 border-dashed rounded-lg cursor-pointer bg-slate-50 dark:hover:bg-bray-800 dark:bg-slate-700 hover:bg-slate-100 dark:border-slate-600 dark:hover:border-slate-500 dark:hover:bg-slate-600 ".concat(i.className||""),children:[(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[l?(0,n.jsx)(r.Z,{className:"w-10 h-10 mb-4 text-slate-500"}):(0,n.jsx)(s.Z,{className:"w-10 h-10 mb-4 text-slate-500"}),(0,n.jsx)("p",{className:"mb-2 text-base text-slate-500 dark:text-slate-400",children:"Click to upload or drag and drop"}),(0,n.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a})]}),(0,n.jsx)("input",{...o,id:t,className:"hidden ".concat(o.className||"")})]})})},i=l(5693),c=l(47);function d(e){return void 0===e||e.visible}function u(e){return void 0===e||e.visible}function m(e){let{wbrow:t,columns:l,idx:n}=e,a=0,s=null,r=1,o=1,u=t.cells[n],m=l[n];return(void 0===m||m.visible)&&(a++,u?(s=function(e){let t=e.value;if(null==t||t!=t)null===t&&(t="");else{let l;i.isString(t)&&"'"==t.charAt(0)&&(t=t.substring(1)),e.style&&e.style.format&&(l=c.Workbook.fromXlsxFormat(e.style.format)[0]);let n=void 0!==l&&l.length>0?i.Globalize.format(t,l):t;t=i.escapeHtml(n)}return t}(u),u.colSpan&&u.colSpan>1&&(a+=(r=function(e){let{columns:t,startFrom:l,colSpan:n}=e,a=n;for(let e=l;e<t.length&&e<l+n;e++)!d(t[e])&&a--;return a}({columns:l,startFrom:n,colSpan:u.colSpan}))-1,n+=u.colSpan-1),u.rowSpan&&(o=u.rowSpan)):s=""),{value:s,rowSpan:o,colSpan:r,num_cell:a,idx:n}}var x=e=>{let{wbrow:t,columns:l,rowIdx:a,maxRows:s=100,invisColCnt:r=0,isKpiTargetRow:o=!1,kpiColIdx:i=0,dateRowIdx:c=0,className:d="",...u}=e,x=[],p=0;for(let e=0;t.cells&&e<t.cells.length&&!(e>=s);e++){let n=m({wbrow:t,columns:l,idx:e});null!==n.value&&(x.push({scol:e,ecol:n.idx,colSpan:n.colSpan,rowSpan:n.rowSpan,value:n.value}),p+=n.num_cell),e=n.idx}let h=s-p-r;for(let e=0;e<h;e++)x.push({scol:p+e,ecol:p+e,colSpan:1,rowSpan:1,value:""});return(0,n.jsx)("tr",{...u,className:"border-slate-800 border-2 table-wbrow align-middle ".concat(d),children:x.map((e,t)=>{let{scol:l,ecol:s,colSpan:r,rowSpan:d,value:u}=e;return(0,n.jsx)("td",{className:"truncate px-2 py-1 border border-1 border-slate-800 max-w-48 ".concat(a===c&&l>=i?"bg-yellow-300 ".concat(l<=i&&i<=s?"font-bold":""):o&&l>=i?"bg-amber-400 ".concat(l<=i&&i<=s?"font-bold":""):l<=i&&i<=s?"bg-red-300 font-bold":""),colSpan:r,rowSpan:d,children:u},t)})})},p=e=>{let{worksheet:t,kpis:l,dateRowIdx:a=0,kpiColIdx:s=0,maxColumns:r=100,maxRows:o=200,className:i="",...c}=e;if(!t)return(0,n.jsx)("div",{className:"text-red-100",children:"Please Upload the Excel File Correctly"});let d=t.columns||[],u=t.rows.filter(e=>void 0===e||e.visible).slice(0,o),m=d.length;for(let e of u)e&&e.cells&&(m=Math.max(m,e.cells.length));return m=Math.min(m,r),(0,n.jsx)("div",{className:"w-full overflow-x-auto h-full",children:(0,n.jsxs)("table",{className:"border-collapse table-fixd w-full shadow-md rounded-xl bg-white text-slate-800 ".concat(i),...c,children:[(0,n.jsx)("colgroup",{children:d.filter(e=>e.visible).slice(0,m).map((e,t)=>(0,n.jsx)("col",{width:e.autoWidth?"":null!=e.width?"".concat(e.width,"px"):"60px"},t))}),(0,n.jsx)("tbody",{className:"table-row-group",children:u.map((e,t)=>(0,n.jsx)(x,{rowIdx:t,wbrow:e,columns:d,maxRows:m,invisColCnt:d.filter(e=>!1===e.visible).length,kpiColIdx:s,dateRowIdx:a,isKpiTargetRow:l.some(e=>e.row===t)},"row-".concat(t)))})]})})},h=l(6840),f=l(1824),b=e=>{let{workbook:t,sheetIndex:l,setSheetIndex:a,className:s="",...r}=e;return(0,n.jsx)("div",{...r,className:"w-full ".concat(s),children:(0,n.jsx)(f.Z,{value:l,onChange:(e,t)=>{a(t)},TabIndicatorProps:{style:{backgroundColor:"rgb(248, 250, 252)",height:"4px"}},textColor:"inherit",variant:"scrollable",scrollButtons:"auto","aria-label":"sheet name tabs",className:"bg-green-700 text-slate-50 p-0",children:t.sheets.map((e,t)=>(0,n.jsx)(h.Z,{value:t,label:e.name},t))})})},g=l(278),w=l(8836);let j=(0,w.ZP)(g.Z,{shouldForwardProp:e=>!["open","drawerWidth"].includes(e)})(e=>{let{theme:t,open:l,drawerWidth:n}=e;return{transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),...l&&{width:"calc(100% - ".concat(n,"px)"),marginLeft:"".concat(n,"px"),transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})}}});var v=l(2e3),N=l(4091);let k=(0,N.Z)("https://iwasakishuto.github.io","/xlxtractor");function S(e,t){let l=document.createElement("a");l.href=e,l.download=t,l.click(),URL.revokeObjectURL(e)}var C=l(3680),y=l(6285),Z=l(5195),F=l(5996),P=l(7002),I=l(3340),R=e=>{let{className:t="",...l}=e,{showAlertSnack:s}=(0,a.useContext)(v.SnackbarContext);return(0,n.jsxs)(Z.Z,{...l,className:"max-w-md px-4 py-2 min-w-80 mx-auto bg-slate-50 overflow-y-auto ".concat(t),children:[(0,n.jsx)(P.Z,{title:"Sample Excel File",className:"border-b-2 border-slate-400 pb-1"}),(0,n.jsx)(I.Z,{component:"img",height:"194",image:(0,N.Z)(k,"/excel/SaaS_KPI_sample_xl_v0.png"),alt:"Sample Excel"}),(0,n.jsx)(F.Z,{children:(0,n.jsx)(y.Z,{className:"normal-case font-bold w-full py-2 bg-rose-600 text-slate-100 hover:bg-rose-700 hover:text-white",endIcon:(0,n.jsx)(C.Z,{}),onClick:e=>{try{let e=(0,N.Z)(k,"/excel/SaaS_KPI_v0.xlsx");S(e,"SaaS_KPI_v0.xlsx"),s({message:"Downloading sample excel file from ".concat(e,"..."),severity:"info"})}catch(e){s({message:"Failed to download sample excel file.\n".concat(e),severity:"error"})}},children:"Download Excel"})})]})};let E={100:"#DAECFF",200:"#80BFFF",400:"#3399FF",500:"#007FFF",600:"#0072E5",700:"#0059B2",900:"#003A75"},D={50:"#F3F6F9",100:"#E5EAF2",200:"#DAE2ED",300:"#C7D0DD",400:"#B0B8C4",500:"#9DA8B7",600:"#6B7A90",700:"#434D5B",800:"#303740",900:"#1C2025"};var O=l(2056),B=l(8315),A=l(7719);let _=a.forwardRef(function(e,t){return(0,n.jsx)(O.Y,{min:0,step:1,slots:{root:z,input:K,incrementButton:L,decrementButton:L},slotProps:{incrementButton:{children:"▴"},decrementButton:{children:"▾"}},...e,ref:t})}),z=(0,A.Z)("div")(e=>{let{theme:t}=e;return"\n  font-family: 'IBM Plex Sans', sans-serif;\n  font-weight: 400;\n  border-radius: 8px;\n  color: ".concat("dark"===t.palette.mode?D[300]:D[900],";\n  background: ").concat("dark"===t.palette.mode?D[900]:"#fff",";\n  border: 1px solid ").concat("dark"===t.palette.mode?D[700]:D[200],";\n  box-shadow: 0px 2px 4px ").concat("dark"===t.palette.mode?"rgba(0,0,0, 0.5)":"rgba(0,0,0, 0.05)",";\n  display: grid;\n  grid-template-columns: 1fr 19px;\n  grid-template-rows: 1fr 1fr;\n  overflow: hidden;\n  column-gap: 8px;\n  padding: 4px;\n\n  &.").concat(B.S.focused," {\n    border-color: ").concat(E[400],";\n    box-shadow: 0 0 0 3px ").concat("dark"===t.palette.mode?E[700]:E[200],";\n  }\n\n  &:hover {\n    border-color: ").concat(E[400],";\n  }\n\n  // firefox\n  &:focus-visible {\n    outline: 0;\n  }\n")}),K=(0,A.Z)("input")(e=>{let{theme:t}=e;return"\n  font-size: 0.875rem;\n  font-family: inherit;\n  font-weight: 400;\n  line-height: 1.5;\n  grid-column: 1/2;\n  grid-row: 1/3;\n  color: ".concat("dark"===t.palette.mode?D[300]:D[900],";\n  background: inherit;\n  border: none;\n  border-radius: inherit;\n  padding: 8px 12px;\n  outline: 0;\n")}),L=(0,A.Z)("button")(e=>{let{theme:t}=e;return"\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: center;\n  align-items: center;\n  appearance: none;\n  padding: 0;\n  width: 19px;\n  height: 19px;\n  font-family: system-ui, sans-serif;\n  font-size: 0.875rem;\n  line-height: 1;\n  box-sizing: border-box;\n  background: ".concat("dark"===t.palette.mode?D[900]:"#fff",";\n  border: 0;\n  color: ").concat("dark"===t.palette.mode?D[300]:D[900],";\n  transition-property: all;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 120ms;\n\n  &:hover {\n    background: ").concat("dark"===t.palette.mode?D[800]:D[50],";\n    border-color: ").concat("dark"===t.palette.mode?D[600]:D[300],";\n    cursor: pointer;\n  }\n\n  &.").concat(B.S.incrementButton," {\n    grid-column: 2/3;\n    grid-row: 1/2;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border: 1px solid;\n    border-bottom: 0;\n    border-color: ").concat("dark"===t.palette.mode?D[700]:D[200],";\n    background: ").concat("dark"===t.palette.mode?D[900]:D[50],";\n    color: ").concat("dark"===t.palette.mode?D[200]:D[900],";\n\n    &:hover {\n      cursor: pointer;\n      color: #FFF;\n      background: ").concat("dark"===t.palette.mode?E[600]:E[500],";\n      border-color: ").concat("dark"===t.palette.mode?E[400]:E[600],";\n    }\n  }\n\n  &.").concat(B.S.decrementButton," {\n    grid-column: 2/3;\n    grid-row: 2/3;\n    border-bottom-left-radius: 4px;\n    border-bottom-right-radius: 4px;\n    border: 1px solid;\n    border-color: ").concat("dark"===t.palette.mode?D[700]:D[200],";\n    background: ").concat("dark"===t.palette.mode?D[900]:D[50],";\n    color: ").concat("dark"===t.palette.mode?D[200]:D[900],";\n  }\n\n  &:hover {\n    cursor: pointer;\n    color: #FFF;\n    background: ").concat("dark"===t.palette.mode?E[600]:E[500],";\n    border-color: ").concat("dark"===t.palette.mode?E[400]:E[600],";\n  }\n\n  & .arrow {\n    transform: translateY(-1px);\n  }\n\n  & .arrow {\n    transform: translateY(-1px);\n  }\n")});var M=l(6969),H=l(8963),U=l(1518),W=l(6273),T=l(8563),G=l(2508),V=l(9016);let Y=e=>{let{label:t,num:l,setNum:a,disabled:s}=e;return(0,n.jsxs)(G.ZP,{xs:12,sm:6,container:!0,className:"items-center",children:[(0,n.jsxs)("label",{className:"ml-auto mr-1",id:"dispColumns",children:[t,"："]}),(0,n.jsx)(_,{id:"dispColumns",value:l,onChange:e=>{e.target instanceof HTMLInputElement&&a(Number(e.target.value))},onInputChange:e=>{e.target instanceof HTMLInputElement&&a(Number(e.target.value))},className:"w-16 mr-auto",disabled:s})]},t)};var q=e=>{let{sheet:t,excelFilename:l,setExcelFilename:s,kpiColIdx:r,setKpiColIdx:o,dateRowIdx:i,setDateRowIdx:c,kpis:d,setKpis:x,kpiOptions:p,dispColumns:h,setDispColumns:f,dispRows:b,setDispRows:g,maxColumns:w,maxRows:j,className:N="",...k}=e,{showAlertSnack:I}=(0,a.useContext)(v.SnackbarContext);return(0,n.jsxs)(Z.Z,{...k,className:"max-w-md px-4 py-2 min-w-80 mx-auto bg-slate-50 overflow-y-auto ".concat(N),children:[(0,n.jsx)(P.Z,{action:(0,n.jsx)(U.Z,{className:"mr-1"}),title:"設定",className:"border-b-2 border-slate-400 pb-1"}),(0,n.jsx)(F.Z,{children:(0,n.jsxs)(G.ZP,{container:!0,spacing:1,className:"mt-4",children:[l.length>0&&(0,n.jsxs)(G.ZP,{container:!0,children:[(0,n.jsxs)(G.ZP,{container:!0,xs:12,className:"mb-4 items-center w-full",children:[(0,n.jsx)("span",{className:"ml-auto",children:"Excel："}),(0,n.jsx)("code",{className:"mr-auto",children:l})]}),(0,n.jsxs)(G.ZP,{container:!0,xs:12,className:"mb-4 w-full",children:[(0,n.jsxs)(G.ZP,{item:!0,xs:12,sm:6,className:"items-center flex",children:[(0,n.jsx)("span",{className:"ml-auto",children:"最大列数："}),(0,n.jsx)("code",{className:"mr-auto",children:w})]}),(0,n.jsxs)(G.ZP,{item:!0,xs:12,sm:6,className:"items-center flex",children:[(0,n.jsx)("span",{className:"ml-auto",children:"最大行数："}),(0,n.jsx)("code",{className:"mr-auto",children:j})]})]})]}),(0,n.jsxs)(G.ZP,{container:!0,className:"mb-6 items-center",children:[(0,n.jsx)(Y,{label:"列数",num:h,setNum:f,disabled:null===t}),(0,n.jsx)(Y,{label:"行数",num:b,setNum:g,disabled:null===t})]}),(0,n.jsxs)(G.ZP,{container:!0,className:"mb-6 items-center",children:[(0,n.jsx)(Y,{label:"KPI列",num:r,setNum:o,disabled:null===t}),(0,n.jsx)(Y,{label:"日付行",num:i,setNum:c,disabled:null===t})]}),(0,n.jsx)(G.ZP,{item:!0,xs:12,children:(0,n.jsx)(W.Z,{multiple:!0,disableCloseOnSelect:!0,options:p,getOptionLabel:e=>e.label,isOptionEqualToValue:(e,t)=>e.row===t.row,renderOption:(e,t,l)=>{let{className:s="",...r}=e,{selected:o}=l;return(0,a.createElement)("li",{...r,className:"".concat(s," text-sm"),key:t.row,children:[(0,n.jsx)(T.Z,{icon:(0,n.jsx)(H.Z,{fontSize:"small"}),checkedIcon:(0,n.jsx)(M.Z,{fontSize:"small"}),checked:o,className:"mr-2 py-0"}),t.label]})},renderInput:e=>(0,n.jsx)(V.Z,{...e,label:"KPIs",placeholder:"[Alt] + [↓]"}),className:"w-full text-xl",value:d,size:"small",onChange:(e,t)=>{x(t),console.log(["newValue",t])},ChipProps:{className:"bg-orange-200"},disabled:null===t})}),(0,n.jsx)(G.ZP,{item:!0,xs:12,className:"mt-8",children:(0,n.jsx)(y.Z,{className:"normal-case font-bold w-full py-2 bg-green-700 text-slate-100 hover:bg-green-600 hover:text-white",endIcon:(0,n.jsx)(C.Z,{}),onClick:e=>{if(null!==t){let e=l+".kpi.json",n=function(e){let{sheet:t,kpis:l,kpiColIdx:n,dateRowIdx:a}=e,s=t.columns||[];function r(e,t){let l="",n=[];for(let a=0;e.cells&&a<e.cells.length;a++){let{value:r,idx:o,num_cell:i}=m({wbrow:e,columns:s,idx:a});a<=t&&t<=o&&(l=r||""),a>t&&n.push(r);for(let e=0;e<i-1;e++)n.push(null);a=o}return[l,n]}let o={Date:[],KPIs:{},excelFilename:""};return t.rows&&t.rows.filter(e=>u(e)).forEach((e,t)=>{if(t===a){let[t,l]=r(e,n);o.Date=l}if(l.some(e=>e.row===t)){let[t,l]=r(e,n);o.KPIs[t]=l}}),o}({sheet:t,kpis:d,kpiColIdx:r,dateRowIdx:i});n.excelFilename=l,function(e,t){let l=new Blob([JSON.stringify(e)],{type:"application/json"});S(URL.createObjectURL(l),t)}(n,e),I({message:"KPI file '".concat(e,"' was downloaded successfully"),severity:"success"})}else I({message:"Please Upload the Excel File Correctly",severity:"error"})},children:"Download KPIs"})})]})})]})};let J=(0,w.ZP)("div")(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",padding:t.spacing(0,1),...t.mixins.toolbar,justifyContent:"flex-end"}}),Q=(0,w.ZP)("main",{shouldForwardProp:e=>!["open","drawerWidth"].includes(e)})(e=>{let{theme:t,open:l,drawerWidth:n}=e;return{flexGrow:1,padding:t.spacing(3),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginLeft:"-".concat(n,"px"),...l&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginLeft:0}}}),X=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],$=["New MRR","LTV","CAC","Magic Number","Burn Multiple","Net Burn","ARPU","ARR","MRR","Quick Ratio","Churn Rate","NPS","CES","COGS","R&D","S&M","G&A","FCF"];var ee=l(6849),et=l(8740),el=l(3801),en=l(8416),ea=l(6892),es=l(3206),er=l(6676),eo=l(9835),ei=()=>{let[e,t]=(0,a.useState)(!1),[l,s]=(0,a.useState)(null),[r,i]=(0,a.useState)(0),[x,h]=(0,a.useState)(!1),[f,g]=(0,a.useState)(""),[w,v]=(0,a.useState)(0),[S,C]=(0,a.useState)(0),[y,Z]=(0,a.useState)([]),[F,P]=(0,a.useState)([]),[I,E]=(0,a.useState)(0),[D,O]=(0,a.useState)(0),[B,A]=(0,a.useState)(200),[_,z]=(0,a.useState)(100);return(0,a.useEffect)(()=>{if(null!==l){Z([]),P([]),E(0),O(0);let e=l.sheets[r];e&&(v(e.rows.filter(e=>u(e)).length),C(e.columns.filter(e=>d(e)).length))}},[r]),(0,a.useEffect)(()=>{if(null!==l){let e=[],t=[],n=l.sheets[r].columns||[];l.sheets[r].rows.filter(e=>void 0==e||e.visible).slice(0,B).forEach((l,a)=>{for(let s=0;l.cells&&s<l.cells.length;s++){let{value:r,idx:o}=m({wbrow:l,columns:n,idx:s});if(s<=I&&I<=o){null===r||e.map(e=>e.label).includes(r)||($.some(e=>null!==r&&r.includes(e))&&(t=[...t,{label:r,row:a}]),e=[...e,{label:r,row:a}]);break}s=o}}),Z(t),P(e)}},[I,B,r]),(0,n.jsxs)("div",{className:"flex min-h-full",children:[(0,n.jsx)(j,{position:"fixed",className:"bg-green-700",open:e,drawerWidth:400,style:{height:"".concat(64,"px")},children:(0,n.jsxs)(er.Z,{children:[(0,n.jsx)(es.Z,{color:"inherit","aria-label":"open drawer",onClick:()=>{t(!0)},edge:"start",sx:{mr:2,...e&&{display:"none"}},children:(0,n.jsx)(et.Z,{})}),(0,n.jsx)(eo.Z,{variant:"h6",noWrap:!0,component:"div",children:"Excel Extractor"}),(0,n.jsx)(el.Z,{className:"ml-auto mr-2",alt:"Icon",src:(0,N.Z)(k,"favicon.png")})]})}),(0,n.jsxs)(ea.ZP,{sx:{width:400,"& .MuiDrawer-paper":{width:400,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:e,className:"flex-shrink-0",PaperProps:{className:"bg-slate-200 text-slate-800"},children:[(0,n.jsx)(J,{className:"bg-slate-800 text-slate-200",children:(0,n.jsxs)("div",{className:"flex items-center w-full",children:[(0,n.jsx)("div",{className:"mx-auto text-xl font-bold",children:"Settings"}),(0,n.jsx)(es.Z,{onClick:()=>{t(!1)},children:(0,n.jsx)(ee.Z,{className:"text-slate-100"})})]})}),(0,n.jsx)(en.Z,{}),(0,n.jsxs)("div",{style:{width:340},className:"mx-auto mt-2",children:[(0,n.jsx)(q,{sheet:null!==l?l.sheets[r]:null,kpiColIdx:I,dateRowIdx:D,kpis:y,setKpiColIdx:E,setDateRowIdx:O,setKpis:Z,kpiOptions:F,excelFilename:f,setExcelFilename:g,dispColumns:_,setDispColumns:z,dispRows:B,setDispRows:A,maxColumns:S,maxRows:w}),(0,n.jsx)(R,{className:"mt-12"})]})]}),(0,n.jsxs)(Q,{open:e,drawerWidth:400,className:"bg-slate-200 text-slate-800 h-screen p-0",children:[(0,n.jsx)(J,{}),(0,n.jsxs)("div",{className:"w-full flex",style:{height:"calc(100% - ".concat(64,"px)")},children:[(0,n.jsx)("div",{className:"max-w-4xl 2xl:max-w-7xl w-full bg-slate-100 p-6",children:(0,n.jsx)("div",{className:"flex flex-col h-full",children:(0,n.jsx)("div",{className:"flex-1 items-stretch w-full h-full",children:null===l?(0,n.jsx)(o,{id:"excel-file",className:"w-full h-full px-6 py-2",text:"Any Excel file here!!",inputProps:{type:"file",accept:X.join(", "),onChange:e=>{e.preventDefault();let t=e.currentTarget.files;if(t&&t.length){let e=t[0];g(e.name),h(!0);let l=new FileReader;l.onload=()=>{l.result&&new c.Workbook().loadAsync(l.result,e=>{s(e),h(!1)})},l.readAsDataURL(e)}}},loading:x}):(0,n.jsxs)("div",{className:"w-full h-full px-6 py-2",children:[(0,n.jsx)(b,{workbook:l,sheetIndex:r,setSheetIndex:i}),(0,n.jsx)(p,{worksheet:null==l?void 0:l.sheets[r],dateRowIdx:D,kpiColIdx:I,kpis:y,maxRows:B,maxColumns:_})]})})})}),(0,n.jsx)("div",{className:"w-full flex-1",children:!e&&(0,n.jsx)(q,{sheet:null!==l?l.sheets[r]:null,kpiColIdx:I,dateRowIdx:D,kpis:y,setKpiColIdx:E,setDateRowIdx:O,setKpis:Z,kpiOptions:F,className:"max-h-full",excelFilename:f,setExcelFilename:g,dispColumns:_,setDispColumns:z,dispRows:B,setDispRows:A,maxColumns:S,maxRows:w})})]})]})]})}},2e3:function(e,t,l){"use strict";l.r(t),l.d(t,{SnackbarContext:function(){return o},SnackbarContextProvider:function(){return i}});var n=l(7437),a=l(3731),s=l(6251),r=l(2265);/**
 * @file React component of buttons with multiple effects.
 * @author Shuto Iwasaki <https://github.com/iwasakishuto>
 * @copyright Shuto Iwasaki 2024
 * @license MIT
 * @reference <https://mui.com/components/snackbars/>
 */let o=(0,r.createContext)(void 0),i=e=>{let{children:t}=e,[l,i]=(0,r.useState)({isOpen:!1,message:"",severity:"error",vertical:"bottom",horizontal:"right",autoHideDuration:3e3}),c=()=>{i({isOpen:!1,message:"",severity:"error",vertical:"bottom",horizontal:"left",autoHideDuration:3e3})};return(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)(o.Provider,{value:{showAlertSnack:e=>{let{message:t,severity:l="error",vertical:n="bottom",horizontal:a="right",autoHideDuration:s=3e3}=e;i({isOpen:!0,message:t,severity:l,vertical:n,horizontal:a,autoHideDuration:s})}},children:t}),(0,n.jsx)(s.Z,{open:l.isOpen,autoHideDuration:l.autoHideDuration,anchorOrigin:{vertical:l.vertical,horizontal:l.horizontal},onClose:c,className:l.isOpen?"":"hidden",children:(0,n.jsx)(a.Z,{onClose:c,severity:l.severity,className:"w-full",children:l.message})})]})}}},function(e){e.O(0,[565,196,493,817,264,971,69,744],function(){return e(e.s=7641)}),_N_E=e.O()}]);